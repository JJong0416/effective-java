[ì´í™í‹°ë¸Œ ìë°” Effective Java 3/E - YES24](http://www.yes24.com/Product/Goods/65551284)

https://github.com/woowacourse-study/2022-effective-java

[item 23. íƒœê·¸ë‹¬ë¦° í´ë˜ìŠ¤ë³´ë‹¤ëŠ” í´ë˜ìŠ¤ ê³„ì¸µêµ¬ì¡°ë¥¼ í™œìš©í•˜ë¼ Prefer class hierarchies to tagged classes](https://sihyung92.oopy.io/java/effective-java/23)

---

## 1ï¸âƒ£. íƒœê·¸ë‹¬ë¦° í´ë˜ìŠ¤

> íŒŒì¼ëŸ¿ í”„ë¡œì íŠ¸ë¥¼ í•˜ë©´ì„œ íƒœê·¸ë‹¬ë¦° í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ë§ê³  ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ìƒê°í•´ë³´ë¼ëŠ” í”¼ë“œë°±ì„ ë°›ì•˜ë‹¤. ê·¸ë ‡ë‹¤ë©´ `**íƒœê·¸ë‹¬ë¦° í´ë˜ìŠ¤**`ëŠ” ë¬´ì—‡ì¼ê¹Œ?
>

```java
class Figure {

	enum Shape { RECTANGLE, CIRCLE };

	// íƒœê·¸ í•„ë“œ - í˜„ì¬ ëª¨ì–‘ì„ ë‚˜íƒ€ë‚¸ë‹¤.
	final Shape shape;

	// ë‹¤ìŒ í•„ë“œë“¤ì€ ëª¨ì–‘ì´ ì‚¬ê°í˜•ì¼ë•Œë§Œ ì“°ì¸ë‹¤.
	double length;
	double width;

	// ë‹¤ìŒ í•„ë“œëŠ” ëª¨ì–‘ì´ ì›ì¼ë•Œë§Œ ì“°ì¸ë‹¤.
	double radius;

	// ì› ìƒì„±ì
	Figure(double radius) {
		shape = Shape.CIRCLE;
		this.radius = radius;
	}

	// ì‚¬ê°í˜• ìƒì„±ì
	Figure(double length, double width) {
		shape = Shape.RECTANGLE;
		this.length = length;
		this.width = width;
	}

	// ëª¨ì–‘ì— ë”°ë¥¸ ë„“ì´ êµ¬í•˜ê¸°
	double area() {
		switch(shape) {
			case RECTANGLE:
			return length * width;

			case CIRCLE:
			return Math.PI * (radius * radius);

			default:
			throw new AssertionError(shape);
		}
	}
}
```

- 2ê°€ì§€ ì´ìƒì˜ íŠ¹ì •í•œ ê°œë…ì„ í•„ë“œë¥¼ í†µí•´ì„œ í‘œí˜„í•˜ëŠ” í´ë˜ìŠ¤
- í˜„ì¬ í‘œí˜„í•˜ëŠ” ì˜ë¯¸ë¥¼ íƒœê·¸ ê°’ìœ¼ë¡œ ì•Œë ¤ì£¼ëŠ” í´ë˜ìŠ¤

ìì„¸í•œ ëœ»ì„ ëª¨ë¥´ì§€ë§Œ, ì €ìê°€ ë§í•˜ëŠ” íƒœê·¸ë‹¬ë¦° í´ë˜ìŠ¤ëŠ” ìœ„ì™€ ê°™ì€ í´ë˜ìŠ¤ë“¤ì„ ë§í•˜ëŠ” ê²ƒ ê°™ë‹¤.

## 2ï¸âƒ£. í”¼ë“œë°± ë°›ì€ ì½”ë“œë¥¼ í•œë²ˆ ë´ë³´ì.

```java
@Getter
@AllArgsConstructor
public enum ErrorCode {

    // Member ê´€ë ¨ Exception
    MEMBER_NOT_FOUND(HttpStatus.NOT_FOUND, "í•´ë‹¹ ê³„ì •ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."),

    // Board ê´€ë ¨ Exception
    ...

    // Point ê´€ë ¨ Exception
		...

    // Like ê´€ë ¨ Exception
		...

    // Token ê´€ë ¨ Exception
    TOKEN_NOT_EXTRACT(HttpStatus.BAD_REQUEST, "í† í°ì„ ì¶”ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");

    private final HttpStatus status;
    private final String message;
}
```

```java
@ExceptionHandler(CustomException.class)
    protected ResponseEntity<ErrorResponse> handleCustomException(final CustomException e) {
        log.error("handleCustomException: {}", e.getErrorCode());
        return ResponseEntity
            .status(e.getErrorCode().getStatus().value())
            .body(new ErrorResponse(e.getErrorCode()));
    }
```

í•´ë‹¹ ì½”ë“œì—ì„œ ErrorCodeë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ì˜ˆì™¸ ìƒí™©ì„ íƒœê·¸ë¡œ ë¶„ë¥˜í•˜ê³  ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•˜ê³  ìˆë‹¤. ì´ëŠ” íƒœê·¸ë‹¬ë¦° í´ë˜ìŠ¤ì˜ ì¼ì¢…ì´ ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤. íƒœê·¸ë‹¬ë¦° í´ë˜ìŠ¤ëŠ” ë§í–ˆë˜ ê²ƒ ì²˜ëŸ¼ **í•˜ë‚˜ì˜ í´ë˜ìŠ¤ ì•ˆì—ì„œ ì—¬ëŸ¬ ë™ì‘ì„ ë‹¤ë¥´ê²Œ ìˆ˜í–‰í•˜ëŠ” ë°©ì‹ì„ ë§í•©**ë‹ˆë‹¤.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b6ad5bf2-7595-456f-a428-b64169581a74/Untitled.png)

## 3ï¸âƒ£. íƒœê·¸ ë‹¬ë¦° í´ë˜ìŠ¤ëŠ” ì–´ë–¤ ë¶€ë¶„ì—ì„œ ë‹¨ì ì„ ê°€ì§ˆê¹Œ?

- **enumíƒ€ì… ì„ ì–¸, íƒœê·¸ í•„ë“œ, ìŠ¤ìœ„ì¹˜ ë¬¸ ë“± ì“¸ë°ì—†ëŠ” ì½”ë“œê°€ ë§ì•„ì§€ê²Œ ë©ë‹ˆë‹¤.**
- ì—¬ëŸ¬ êµ¬í˜„ì´ í•œ í´ë˜ìŠ¤ì— ëª°ë ¤ ìˆìœ¼ë‹ˆ ê°€ë…ì„±ì´ ë‚˜ì˜ê³  ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤.
- **í•„ë“œë“¤ì´ finalë¡œ ì‚¬ìš©í•˜ë ¤ë©´ ì“°ì´ì§€ ì•ŠëŠ” í•„ë“œê¹Œì§€ ìƒì„±ìì—ì„œ ì´ˆê¸°í™”ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.**
- ë˜ ë‹¤ë¥¸ ì˜ë¯¸ë¥¼ ì¶”ê°€í•˜ë ¤ë©´ ì½”ë“œ ì „ì²´ë¥¼ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.(ëª¨ë“  switch ë¶„ê¸°ì— í•˜ë‚˜ë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.)

## 4ï¸âƒ£. íƒœê·¸ ë‹¬ë¦° í´ë˜ìŠ¤ë¥¼ ê³„ì¸µêµ¬ì¡°ë¡œ ë§Œë“œëŠ” ë°©ë²•

- ê³„ì¸µêµ¬ì¡°ì˜ ë£¨íŠ¸(root)ê°€ ë  ì¶”ìƒ í´ë˜ìŠ¤ë¥¼ ì •ì˜í•œë‹¤.
- íƒœê·¸ ê°’ì— ë”°ë¼ ë™ì‘ì´ ë‹¬ë¼ì§€ëŠ” ë©”ì„œë“œë“¤ì„ ë£¨íŠ¸ í´ë˜ìŠ¤ì˜ ì¶”ìƒ ë©”ì„œë“œë¡œ ì„ ì–¸í•œë‹¤.
- íƒœê·¸ ê°’ì— ìƒê´€ì—†ì´ ë™ì‘ì´ ì¼ì •í•œ ë©”ì„œë“œë“¤ì„ ë£¨íŠ¸ í´ë˜ìŠ¤ì— ì¼ë°˜ ë©”ì„œë“œë¡œ ì¶”ê°€í•œë‹¤.
- ëª¨ë“  í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° í•„ë“œë“¤ë„ ì „ë¶€ ë£¨íŠ¸ í´ë˜ìŠ¤ë¡œ ì˜¬ë¦°ë‹¤.
- ë£¨íŠ¸ í´ë˜ìŠ¤ë¥¼ í™•ì¥í•œ êµ¬ì²´ í´ë˜ìŠ¤ë¥¼ ì˜ë¯¸ë³„ë¡œ í•˜ë‚˜ì”© ì •ì˜í•œë‹¤.
- ê° í•˜ìœ„ í´ë˜ìŠ¤ì—ëŠ” ê°ìì˜ ì˜ë¯¸ì— í•´ë‹¹í•˜ëŠ” ë°ì´í„° í•„ë“œë¥¼ ë„£ëŠ”ë‹¤.
- ë£¨íŠ¸ í´ë˜ìŠ¤ê°€ ì •ì˜í•œ ì¶”ìƒ ë©”ì„œë“œë¥¼ ê°ìì˜ ì˜ë¯¸ì— ë§ê²Œ êµ¬í˜„í•œë‹¤.

## 5ï¸âƒ£. íƒœê·¸ë‹¬ë¦° í´ë˜ìŠ¤ì˜ ëŒ€ì•ˆ

ì í•œë²ˆ **`Figure.java`** ë¥¼ í•œë²ˆ ë°”ê¿”ë³´ì.

```java
abstract class Figure {
	abstract double area();
}

class Circle extends Figure {
	final double radius;

	Circle(double radius) { this.radius = radius; }

	@Override double area() { return Math.PI * (radius * radius); }
}

class Rectangle extends Figure {
	final double length;
	final double width;

	Rectangle(double length, double width) {
		this.length = length;
		this.width = width;
	}

	@Override double area() { return length * width; }
}
```

ì´ëŸ° êµ¬ì¡°ë¥¼ í™œìš©í•˜ë©´, íƒœê·¸ë‹¬ë¦° í´ë˜ìŠ¤ì˜ ë‹¨ì ë“¤ì„ ëª¨ë‘ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 6ï¸âƒ£. í”¼ë“œë°± ë°›ì€ ì½”ë“œë“¤ì„ ìˆ˜ì •í•´ë³´ì.

```java
@Getter
@AllArgsConstructor
public class BusinessException extends RuntimeException {
    private final HttpStatus status;
    private final String message;
}
```

```java
@Slf4j
@RestControllerAdvice
public class GlobalExceptionHandler {

    @ExceptionHandler(BusinessException.class)
    protected ResponseEntity<ErrorResponse> handleCustomException(final BusinessException e) {
        log.error("handleCustomException: {}", e.getMessage());
        return ResponseEntity
            .status(e.getStatus().value())
            .body(new ErrorResponse(e.getStatus(), e.getMessage()));
    }
}
```

```java
@Getter
public class BoardNotFoundException extends BusinessException {

    private static final String MESSAGE = "ë²ˆ ê²Œì‹œë¬¼ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";

    public BoardNotFoundException(Long boardId) {
        super(HttpStatus.NOT_FOUND, boardId + MESSAGE);
    }
}
```

ê³µí†µì˜ ì—­í• ì„ í•˜ëŠ” ë¶€ë¶„ì€ ì¶”ìƒí´ë˜ìŠ¤ë¡œ, êµ¬í˜„ í´ë˜ìŠ¤ëŠ” ê°ê°ì˜ íŒ¨í‚¤ì§€ì—ì„œ ì‘ì„±í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. ğŸ˜€

## 7ï¸âƒ£. í´ë˜ìŠ¤ ê³„ì¸µ êµ¬ì¡°ì˜ ì¥ì 

- ì“¸ë°ì—†ëŠ” ì½”ë“œê°€ ëª¨ë‘ ì‚¬ë¼ì§„ë‹¤.
- ê° ì˜ë¯¸ë¥¼ ë…ë¦½ëœ í´ë˜ìŠ¤ì— ë‹´ì•„ ê´€ë ¨ ì—†ë˜ ë°ì´í„° í•„ë“œë¥¼ ëª¨ë‘ ì œê±°í•  ìˆ˜ ìˆìœ¼ë©°, ì‚´ì•„ë‚¨ì€ í•„ë“œë“¤ì€ ëª¨ë‘ finalì´ë‹¤.
- ê° í´ë˜ìŠ¤ì˜ ìƒì„±ìê°€ ëª¨ë“  í•„ë“œë¥¼ ë‚¨ê¹€ì—†ì´ ì´ˆê¸°í™”í•˜ê³  ì¶”ìƒ ë©”ì„œë“œë¥¼ ëª¨ë‘ êµ¬í˜„í–ˆëŠ”ì§€ ì»´íŒŒì¼ëŸ¬ê°€ í™•ì¸í•´ì¤€ë‹¤.
- ì‹¤ìˆ˜ë¡œ ë¹¼ë¨¹ì€ case ë¬¸ ë•Œë¬¸ì— ëŸ°íƒ€ì„ ì˜¤ë¥˜ê°€ ë°œìƒí•  ì¼ì´ ì—†ë‹¤.